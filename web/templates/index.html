<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ELBOT Control Center</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #ffffff;
      color: #000000;
      padding: 2rem;
    }

    h1 {
      font-weight: 700;
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .status-badge {
      font-size: 0.9rem;
      font-weight: 600;
      padding: 0.5rem 1rem;
      border-radius: 5px;
    }

    .btn-custom {
      text-transform: uppercase;
      font-weight: 600;
      font-size: 0.9rem;
      border: none;
      padding: 0.75rem;
      width: 100%;
      transition: all 0.2s ease-in-out;
    }

    .btn-custom:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #000;
    }

    .log-box {
      background-color: #111;
      color: #00ff00;
      font-family: monospace;
      height: 300px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 1rem;
      white-space: pre-wrap;
      box-shadow: inset 0 0 10px #0f0;
    }

    .section-header {
      border-bottom: 2px solid #000;
      padding-bottom: 0.5rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <h1>ELBOT</h1>
  <div class="mb-3">
    <span class="status-badge bg-success text-white" id="botStatus">Status: Running</span>
    <span class="ms-3 text-muted" id="lastUpdate">Last Update: --</span>
  </div>

  <!-- Control Buttons -->
  <div class="row g-3 mb-4">
    <div class="col-md-3"><a href="/action/start" class="btn btn-custom btn-success">Start</a></div>
    <div class="col-md-3"><a href="/action/stop" class="btn btn-custom btn-danger">Stop</a></div>
    <div class="col-md-3"><a href="/action/restart" class="btn btn-custom btn-warning">Restart</a></div>
    <div class="col-md-3"><a href="/action/update" class="btn btn-custom btn-primary">Update</a></div>
  </div>

  <!-- Logs -->
  <div class="section-header">Logs</div>
  <div class="log-box" id="logOutput">Loading logs...</div>

  <!-- System Stats -->
  <div class="section-header">System Monitor</div>
  <div class="row">
    <div class="col-md-3"><strong>CPU Usage:</strong> <span id="cpu">--</span>%</div>
    <div class="col-md-3"><strong>RAM:</strong> <span id="ram">--</span>%</div>
    <div class="col-md-3"><strong>Disk:</strong> <span id="disk">--</span>%</div>
    <div class="col-md-3"><strong>Uptime:</strong> <span id="uptime">--</span></div>
  </div>

  <!-- Command Console -->
  <div class="section-header">Command Runner</div>
  <form id="commandForm">
    <div class="mb-3">
      <input type="text" class="form-control" id="commandInput" placeholder="Enter shell command...">
    </div>
    <button type="submit" class="btn btn-dark">Run Command</button>
  </form>
  <pre class="mt-3 log-box" id="commandOutput">Waiting for input...</pre>

  <!-- Git Branch Switcher -->
  <div class="section-header">Git Branch</div>
  <form id="branchForm">
    <div class="row g-2">
      <div class="col-md-8">
        <select class="form-select" id="branchSelect">
          <option>main</option>
          <option>Working</option>
          <option>Testing</option>
          <option>before-apr12th</option>
        </select>
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-secondary w-100">Switch Branch</button>
      </div>
    </div>
  </form>
  <pre class="mt-3 log-box" id="branchOutput">Current branch: --</pre>

  <!-- Environment Variables -->
  <div class="section-header">Environment Variables</div>
  <pre class="log-box" id="envOutput">Loading environment variables...</pre>

  <!-- Auto-Restart Scheduler -->
  <div class="section-header">Auto-Restart Scheduler</div>
  <form id="scheduleForm">
    <div class="row g-2">
      <div class="col-md-5">
        <input type="text" id="scheduleTime" class="form-control" placeholder="HH MM (e.g., 3 0 for 3:00 AM)">
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-outline-dark w-100">Set Restart Time</button>
      </div>
    </div>
  </form>
  <pre class="mt-3 log-box" id="scheduleOutput">Awaiting input...</pre>

  <!-- Scripts -->
  <script>
    // Log auto-refresh
    setInterval(() => {
      fetch('/api/logs')
        .then(res => res.json())
        .then(data => {
          document.getElementById('logOutput').textContent = data.logs;
        });
    }, 10000);

    // System stats auto-refresh
    setInterval(() => {
      fetch('/api/system')
        .then(res => res.json())
        .then(data => {
          document.getElementById('cpu').textContent = data.cpu;
          document.getElementById('ram').textContent = data.ram;
          document.getElementById('disk').textContent = data.disk;
          document.getElementById('uptime').textContent = data.uptime;
        });
    }, 10000);

    // Initial bot status
    fetch('/api/status')
      .then(res => res.json())
      .then(data => {
        document.getElementById('botStatus').textContent = 'Status: ' + data.status;
        document.getElementById('botStatus').className = 'status-badge ' + (data.status === 'Running' ? 'bg-success' : 'bg-danger') + ' text-white';
        document.getElementById('lastUpdate').textContent = 'Last Update: ' + data.last_update;
      });

    // Command Runner
    document.getElementById('commandForm').addEventListener('submit', e => {
      e.preventDefault();
      const cmd = document.getElementById('commandInput').value;
      fetch('/run-command', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ command: cmd })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('commandOutput').textContent = data.output;
      });
    });

    // Git Branch Switcher
    document.getElementById('branchForm').addEventListener('submit', e => {
      e.preventDefault();
      const branch = document.getElementById('branchSelect').value;
      fetch('/switch-branch', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ branch })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('branchOutput').textContent = data.output;
      });
    });

    // Load environment variables
    fetch('/api/env')
      .then(res => res.json())
      .then(data => {
        const entries = Object.entries(data).map(([key, val]) => `${key}: ${val}`).join('\n');
        document.getElementById('envOutput').textContent = entries;
      });

    // Auto-Restart Scheduler
    document.getElementById('scheduleForm').addEventListener('submit', e => {
      e.preventDefault();
      const time = document.getElementById('scheduleTime').value.trim();
      fetch(`/action/schedule:${time}`)
        .then(() => {
          document.getElementById('scheduleOutput').textContent = `Restart scheduled for ${time}`;
        });
    });
  </script>
</body>
</html>



